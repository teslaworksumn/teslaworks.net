{% extends "base.html" %}

{% set title =  project_data.name %}
{% set width = 8 %}

{% block html_body %}  
  
<div class="row text-center">
    <h1>{{ project_data.name }}</h1>
    <img class="img-thumbnail img-responsive" src="{{ project_data.photos[0] }}" alt="">
    <p class="lead">{{ project_data.description }}</p>
</div>

{% import 'macros/form.html' as form with context %}

<div class="row">
  <div class="col-sm-6 col-sm-push-6">
    <a class="btn btn-primary btn-lg btn-block" data-toggle="collapse" data-target="#join">Join This Project</a>
    <div id="join" class="disclose-form collapse{% if errors['join_email'] %} in{% endif %}">
      {{ form.start('join-form') }}
      {{ form.input('email', 'join_email', "Email Address", "What's your email?", 'md') }}
      {{ form.submit("Join", 'success', 'md') }}
      {{ form.end() }}
    </div>
  </div>
  <div class="col-sm-6 col-sm-pull-6">
    <a class="btn btn-default btn-lg btn-block" data-toggle="collapse" data-target="#ask">Ask A Question</a>
    <div id="ask" class="disclose-form collapse{% if errors['ask_msg'] or errors['ask_email'] %} in{% endif %}">
      {{ form.start('ask-form') }}
      {{ form.textarea('ask_msg', "Message", "What would you like to know?", 'md', 5) }}
      {{ form.input('email', 'ask_email', "Email Address", "What's your email?", 'md') }}
      {{ form.submit("Ask", 'success', 'md') }}
      {{ form.end() }}
    </div>
  </div>
</div>

<hr>

<div class="row">
    <h2>
    {% if project_data.leaders|length > 1 %}
        Project Leaders
    {% else %}
        Project Leader
    {% endif %}
    </h2>
</div>

{% for leader in project_data.leaders %}
<div class="row leader-row">
    <div class="col-sm-3">
        <img src="{{ leader.photo_url }}" alt="" class="img-thumbnail img-responsive">
    </div>
    <div class="col-sm-9">
        <div class="row">
            <h3 class="leader-name">{{ leader.name }}</h3>
            <a href="{{ leader.email }}" class="leader-email">{{ leader.email }}</a>
            <span class="leader-phone">{{ leader.phone }}</span>
        </div>
        {{ leader.bio }}
    </div>
</div>
{% endfor %}

<hr>

{% if project_data.long_description %}
<div class="row">
    <h2>Project Highlights</h2>
    <div style="font-size: 130%;">
        {{ project_data.long_description | nl2br }}
    </div>
</div>
{% endif %}

<hr>

<div class="footer">
    <p>&copy; Tesla Works 2013</p>
</div>

{% endblock %}

{% block html_post_body %}

{% import 'macros/form.js' as form %}

<script type="text/javascript">

  $(document).ready(function(){

    {% if mixpanel_token %}
    mixpanel.track("Project Page", {
      "Project": "{{ project_data.project_title }}"
    });
    mixpanel.track_forms("#join-form", "Join Project", {
      "Project": "{{ project_data.project_title }}"
    });
    mixpanel.track_forms("#ask-form", "Ask Question About Project", {
      "Project": "{{ project_data.project_title }}"
    });
    {% endif %}

    {{ form.js() | safe }}
  });
</script>

{% endblock %}
